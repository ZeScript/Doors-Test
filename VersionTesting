wait(1)

if getgenv().ZeScriptLoaded then
    warn("ZeScript is already running! Please destroy the existing instance first.")
    return
end
getgenv().ZeScriptLoaded = true

-- Multi-layer authentication check
local function validateAuthentication()
    local env = getgenv()
    
    -- Check 1: Basic existence
    if not env._XASON_MASTER_AUTH_KEY_DO_NOT_TOUCH then
        return false, "Missing master key"
    end
    
    -- Check 2: Loader active flag
    if not env._XASON_LOADER_ACTIVE_V2_SECURE then
        return false, "Loader not active"
    end
    
    -- Check 3: Key length (should be 400+ characters)
    if string.len(env._XASON_MASTER_AUTH_KEY_DO_NOT_TOUCH) < 400 then
        return false, "Invalid key length"
    end
    
    -- Check 4: User ID verification
    if not string.find(env._XASON_MASTER_AUTH_KEY_DO_NOT_TOUCH, "_USER_" .. game.Players.LocalPlayer.UserId) then
        return false, "User mismatch"
    end
    
    -- Check 5: Job ID verification (server-specific)
    if not string.find(env._XASON_MASTER_AUTH_KEY_DO_NOT_TOUCH, "_JOB_" .. game.JobId) then
        return false, "Server mismatch"
    end
    
    -- Check 6: Checksum validation
    if env._XASON_CHECKSUM ~= string.len(env._XASON_MASTER_AUTH_KEY_DO_NOT_TOUCH) then
        return false, "Checksum failed"
    end
    
    -- Check 7: Hash validation
    local function simpleHash(str)
        local hash = 0
        for i = 1, #str do
            hash = (hash + string.byte(str, i)) * 31
            hash = hash % 1000000007
        end
        return hash
    end
    
    if env._XASON_HASH ~= simpleHash(env._XASON_MASTER_AUTH_KEY_DO_NOT_TOUCH) then
        return false, "Hash verification failed"
    end
    
    -- Check 8: Validation function exists and works
    if not env._XASON_VALIDATE or type(env._XASON_VALIDATE) ~= "function" then
        return false, "Validation function missing"
    end
    
    if not env._XASON_VALIDATE() then
        return false, "Validation function returned false"
    end
    
    return true, "Authenticated"
end

-- Run authentication
local authSuccess, authError = validateAuthentication()

if not authSuccess then
    game.Players.LocalPlayer:Kick("âš ï¸ AUTHENTICATION FAILED âš ï¸\n\n" .. 
        "Crap you, you don't have the correct Code!\n\n" ..
        "Error: " .. (authError or "Unknown") .. "\n\n" ..
        "Use the OFFICIAL loader ONLY.\n" ..
        "Stop trying to steal scripts, loser.")
    return
end

-- Add periodic re-checks throughout the script
task.spawn(function()
    while task.wait(math.random(30, 90)) do
        local recheck, error = validateAuthentication()
        if not recheck then
            game.Players.LocalPlayer:Kick("âš ï¸ Session validation failed during runtime.\n\n" .. 
                "Reason: " .. (error or "Unknown") .. "\n\n" ..
                "Nice try bypassing the auth, idiot.")
            break
        end
    end
end)



-- Load XaLib UI Library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/XasonYTB/XaLib/refs/heads/main/UILibrary.lua"))()

loadstring(game:HttpGet("https://raw.githubusercontent.com/XasonYTB/ZeScript-Doors/refs/heads/main/track-track"))() 

-- Create Window
local Window = Library:CreateWindow({
    Title = "ZeScript's Doors",
    Size = Vector2.new(700, 500),
    Keybind = Enum.KeyCode.RightShift
})

-- Floor Detection System
local currentFloor = "Unknown"
local function detectFloor()
    pcall(function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local gameData = ReplicatedStorage:FindFirstChild("GameData")
        if gameData then
            local floorValue = gameData:FindFirstChild("Floor")
            if floorValue then
                currentFloor = floorValue.Value
            end
        end
    end)
    return currentFloor
end

-- Detect floor at start
currentFloor = detectFloor()

-- Create Exploit Category with Tabs
local ExploitCategory = Window:CreateCategory("Exploits", "âš¡")

-- Universal Tab
local UniversalTab = ExploitCategory:CreateTab("Universal", "ðŸŒ")

-- Hotel Tab
local HotelTab = ExploitCategory:CreateTab("Hotel", "ðŸ¨")

-- Mines Tab
local MinesTab = ExploitCategory:CreateTab("Mines", "â›ï¸")

-- Variables
local spoofCrouchEnabled = false
local spoofCrouchLoop

-- ==================== UNIVERSAL TAB ====================

-- Spoof Crouch Toggle
UniversalTab:Toggle("Spoof Crouch", false, function(enabled)
    spoofCrouchEnabled = enabled
    
    if enabled then
        spoofCrouchLoop = task.spawn(function()
            while spoofCrouchEnabled do
                pcall(function()
                    game.ReplicatedStorage.RemotesFolder.Crouch:FireServer(true, true)
                end)
                task.wait(0.32)
            end
        end)
    else
        if spoofCrouchLoop then
            task.cancel(spoofCrouchLoop)
            spoofCrouchLoop = nil
        end
    end
end, "Tricks the game into thinking you're always crouching. Useful for avoiding certain entities!")

-- Disable Screech
local screechDisabled = false
local screechOriginalParent = nil

UniversalTab:Toggle("Disable Screech", false, function(enabled)
    screechDisabled = enabled
    
    pcall(function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local screech = ReplicatedStorage.Entities:FindFirstChild("Screech")
        
        if enabled and screech then
            local zeScriptStuff = ReplicatedStorage:FindFirstChild("ZeScript_Stuff")
            if not zeScriptStuff then
                zeScriptStuff = Instance.new("Folder")
                zeScriptStuff.Name = "ZeScript_Stuff"
                zeScriptStuff.Parent = ReplicatedStorage
            end
            
            local disabledEntity = zeScriptStuff:FindFirstChild("DisabledEntity")
            if not disabledEntity then
                disabledEntity = Instance.new("Folder")
                disabledEntity.Name = "DisabledEntity"
                disabledEntity.Parent = zeScriptStuff
            end
            
            screechOriginalParent = screech.Parent
            screech.Parent = disabledEntity
        elseif not enabled and screech and screechOriginalParent then
            screech.Parent = screechOriginalParent
        end
    end)
end, "Prevents Screech from spawning by moving it to a disabled folder")

-- No Acceleration Toggle
local noAccelEnabled = false
local noAccelLoop = nil
local originalHrpProps = nil

UniversalTab:Toggle("No Acceleration", false, function(enabled)
    noAccelEnabled = enabled

    if enabled then
        pcall(function()
            local Players = game:GetService("Players")
            local LocalPlayer = Players.LocalPlayer or Players.PlayerAdded:Wait()
            local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
            local hrp = Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                originalHrpProps = hrp.CustomPhysicalProperties
                hrp.CustomPhysicalProperties = PhysicalProperties.new(100, 0.7, 0, 1, 1)
            end
        end)

        noAccelLoop = task.spawn(function()
            while noAccelEnabled do
                task.wait(0.5)
                pcall(function()
                    local Players = game:GetService("Players")
                    local LocalPlayer = Players.LocalPlayer
                    local Character = LocalPlayer and LocalPlayer.Character
                    if Character then
                        local hrp = Character:FindFirstChild("HumanoidRootPart")
                        if hrp then
                            local cpp = hrp.CustomPhysicalProperties
                            if not cpp or cpp.Density ~= 100 then
                                hrp.CustomPhysicalProperties = PhysicalProperties.new(100, 0.7, 0, 1, 1)
                            end
                        end
                    end
                end)
            end
        end)
    else
        if noAccelLoop then
            task.cancel(noAccelLoop)
            noAccelLoop = nil
        end

        pcall(function()
            local Players = game:GetService("Players")
            local LocalPlayer = Players.LocalPlayer
            local Character = LocalPlayer and LocalPlayer.Character
            if Character then
                local hrp = Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    hrp.CustomPhysicalProperties = originalHrpProps
                end
            end
        end)

        originalHrpProps = nil
    end
end, "Removes movement acceleration for instant max speed")

-- Proximity Prompt Reach Variables
local proximityReach = 0

UniversalTab:Slider("Proximity Prompt Reach", 0, 12, 0, function(value)
    proximityReach = value
end, "Increases the range at which you can interact with doors, levers, etc.")

-- Auto Proxi Variables
local autoProxiEnabled = false
local autoProxiLoop
local UserInputService = game:GetService("UserInputService")
local isRKeyHeld = false

-- Track R key state
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.R and not gameProcessed then
        isRKeyHeld = true
    end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.R then
        isRKeyHeld = false
    end
end)

UniversalTab:Toggle("Auto Proxi", false, function(enabled)
    autoProxiEnabled = enabled
    
    if enabled then
        autoProxiLoop = task.spawn(function()
            while autoProxiEnabled do
                task.wait(0.34)
                pcall(function()
                    -- Only run if R key is held
                    if not isRKeyHeld then
                        return
                    end

                    print("TestBlah")
                    
                    local Players = game:GetService("Players")
                    local LocalPlayer = Players.LocalPlayer
                    local Character = LocalPlayer and LocalPlayer.Character
                    
                    if Character then
                        local hrp = Character:FindFirstChild("HumanoidRootPart")
                        if hrp then
                            -- Check all proximity prompts in the workspace
                            for _, prompt in pairs(game:FindFirstChild("Workspace"):FindFirstChild("CurrentRooms"):GetDescendants() or {}) do
                                if prompt:IsA("ProximityPrompt") then
                                    local promptParent = prompt.Parent
                                    local distance = (hrp.Position - promptParent.Position).Magnitude
                                    
                                    -- Check if player is in range
                                    local range = promptParent:IsA("BasePart") and promptParent.Size.X or 0
                                    if proximityReach > 0 then
                                        range = proximityReach
                                    else
                                        range = prompt.MaxActivationDistance or 20
                                    end
                                    
                                    if distance <= range then
                                        local actionText = prompt.ActionText or ""
                                        
                                        if prompt.Name == "UnlockPrompt" then
                                            prompt.HoldDuration = 0
                                            prompt:InputHoldBegin()
                                            prompt:InputHoldEnd()
                                        elseif actionText == "Open" or actionText == "Obtain" then
                                            prompt:InputHoldBegin()
                                            prompt:InputHoldEnd()
                                        elseif actionText ~= "Close" then
                                            prompt:InputHoldBegin()
                                            prompt:InputHoldEnd()
                                        end
                                    end
                                end
                            end
                        end
                    end
                end)
            end
        end)
    else
        if autoProxiLoop then
            task.cancel(autoProxiLoop)
            autoProxiLoop = nil
        end
    end
end, "Automatically interacts with nearby prompts when holding R key")

-- Fly and Noclip
local flyEnabled = false
local noclipEnabled = false
local flyLoop

UniversalTab:Toggle("Fly", false, function(enabled)
    flyEnabled = enabled
    
    if enabled then
        flyLoop = task.spawn(function()
            local Players = game:GetService("Players")
            local LocalPlayer = Players.LocalPlayer
            local UserInputService = game:GetService("UserInputService")
            
            while flyEnabled do
                task.wait()
                pcall(function()
                    local Character = LocalPlayer.Character
                    if Character then
                        local climbingAttr = Character:GetAttribute("Climbing")
                        if climbingAttr == false or climbingAttr == nil then
                            local HumanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
                            if HumanoidRootPart then
                                local velocity = Vector3.new(0, 0, 0)
                                
                                if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                                    velocity = velocity + (workspace.CurrentCamera.CFrame.LookVector * 2)
                                end
                                if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                                    velocity = velocity - (workspace.CurrentCamera.CFrame.LookVector * 2)
                                end
                                if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                                    velocity = velocity - (workspace.CurrentCamera.CFrame.RightVector * 2)
                                end
                                if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                                    velocity = velocity + (workspace.CurrentCamera.CFrame.RightVector * 2)
                                end
                                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                                    velocity = velocity + Vector3.new(0, 2, 0)
                                end
                                if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                                    velocity = velocity - Vector3.new(0, 2, 0)
                                end
                                
                                HumanoidRootPart.Velocity = velocity
                                HumanoidRootPart.Anchored = false
                            end
                        end
                    end
                end)
            end
        end)
    else
        if flyLoop then
            task.cancel(flyLoop)
            flyLoop = nil
        end
    end
end, "Use WASD to fly, Space to go up, Shift to go down")

UniversalTab:Toggle("Noclip", false, function(enabled)
    noclipEnabled = enabled
    
    task.spawn(function()
        while noclipEnabled do
            task.wait()
            pcall(function()
                local Players = game:GetService("Players")
                local LocalPlayer = Players.LocalPlayer
                local Character = LocalPlayer.Character
                
                if Character then
                    local climbingAttr = Character:GetAttribute("Climbing")
                    if climbingAttr == false or climbingAttr == nil then
                        for _, part in pairs(Character:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                end
            end)
        end
        
        pcall(function()
            local Players = game:GetService("Players")
            local LocalPlayer = Players.LocalPlayer
            local Character = LocalPlayer.Character
            
            if Character then
                for _, part in pairs(Character:GetDescendants()) do
                    if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                        part.CanCollide = true
                    end
                end
            end
        end)
    end)
end, "Walk through walls and objects")

-- ==================== HOTEL TAB ====================

-- AntiSpeed Bypass Toggle (Hotel only)
local antiSpeedEnabled = false
local antiSpeedLoop
local clonedCollision

    HotelTab:Toggle("AntiSpeed Bypass", false, function(enabled)
        antiSpeedEnabled = enabled
        
        if enabled then
            pcall(function()
                local Players = game:GetService("Players")
                local LocalPlayer = Players.LocalPlayer or Players.PlayerAdded:Wait()
                local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                local CollisionPart = Character:WaitForChild("CollisionPart")
                
                clonedCollision = CollisionPart:Clone()
                clonedCollision.Name = "_CollisionClone"
                clonedCollision.Massless = true
                clonedCollision.Parent = Character
                clonedCollision.CanCollide = false
                clonedCollision.CanQuery = false
                clonedCollision.CustomPhysicalProperties = PhysicalProperties.new(0.01, 0.7, 0, 1, 1)
                
                antiSpeedLoop = task.spawn(function()
                    while antiSpeedEnabled do
                        task.wait(0.23)
                        if clonedCollision then
                            clonedCollision.Massless = false
                            task.wait(0.23)
                            local root = Character:FindFirstChild("HumanoidRootPart")
                            if root and root.Anchored then
                                clonedCollision.Massless = true
                                task.wait(1)
                            end
                            clonedCollision.Massless = true
                        end
                    end
                end)
            end)
        else
            antiSpeedEnabled = false
            if antiSpeedLoop then
                task.cancel(antiSpeedLoop)
                antiSpeedLoop = nil
            end
            if clonedCollision then
                clonedCollision:Destroy()
                clonedCollision = nil
            end
        end
    end, "Required for Speed on Hotel floor - bypasses anticheat")

-- Speed System (Hotel only)
local speedEnabled = false
local originalWalkSpeed = 16
local speedValue = 16
local speedLoop


    HotelTab:Toggle("Speed", false, function(enabled)
        if enabled and not antiSpeedEnabled then
            Window:Notify({
                Text = "Please enable AntiSpeed Bypass first!",
                Duration = 4,
                Type = "Warning"
            })
            speedEnabled = false
            return
        end
        
        speedEnabled = enabled
        
        if enabled then
            pcall(function()
                local Players = game:GetService("Players")
                local LocalPlayer = Players.LocalPlayer
                local Character = LocalPlayer.Character
                
                if Character then
                    local Humanoid = Character:FindFirstChild("Humanoid")
                    if Humanoid then
                        originalWalkSpeed = Humanoid.WalkSpeed
                    end
                end
            end)
            
            speedLoop = task.spawn(function()
                while speedEnabled do
                    task.wait(0.1)
                    pcall(function()
                        local Players = game:GetService("Players")
                        local LocalPlayer = Players.LocalPlayer
                        local Character = LocalPlayer.Character
                        
                        if Character then
                            local Humanoid = Character:FindFirstChild("Humanoid")
                            if Humanoid then
                                Humanoid.WalkSpeed = speedValue
                            end
                        end
                    end)
                end
            end)
        else
            if speedLoop then
                task.cancel(speedLoop)
                speedLoop = nil
            end
            
            pcall(function()
                local Players = game:GetService("Players")
                local LocalPlayer = Players.LocalPlayer
                local Character = LocalPlayer.Character
                
                if Character then
                    local Humanoid = Character:FindFirstChild("Humanoid")
                    if Humanoid then
                        Humanoid.WalkSpeed = originalWalkSpeed
                    end
                end
            end)
        end
    end, "Increase your walk speed - requires AntiSpeed Bypass!")

    HotelTab:Slider("Speed Value", 2, 250, 16, function(value)
        speedValue = value
    end, "Set your desired walk speed (default: 16)")


-- ==================== MINES TAB ====================

-- Mines Anticheat Bypass
local bypassEnabled = false
local bypassLoop
local ladderESP = {}

if currentFloor == "Mines" or currentFloor == "Unknown" then
    MinesTab:Toggle("Anticheat Bypass", false, function(enabled)
        bypassEnabled = enabled
        
        if enabled then
            -- ESP all ladders
            for _, room in pairs(workspace.CurrentRooms:GetChildren()) do
                pcall(function()
                    local ladder = room:FindFirstChild("Ladder", true)
                    if ladder then
                        local highlight = Instance.new("Highlight")
                        highlight.FillColor = Color3.fromRGB(0, 100, 255)
                        highlight.OutlineColor = Color3.fromRGB(0, 150, 255)
                        highlight.FillTransparency = 0.5
                        highlight.OutlineTransparency = 0
                        highlight.Parent = ladder
                        table.insert(ladderESP, highlight)
                    end
                end)
            end
            
            bypassLoop = task.spawn(function()
                local Players = game:GetService("Players")
                local LocalPlayer = Players.LocalPlayer
                
                while bypassEnabled do
                    task.wait(0.1)
                    pcall(function()
                        local Character = LocalPlayer.Character
                        if Character then
                            local climbingAttr = Character:GetAttribute("Climbing")
                            if climbingAttr == true then
                                Window:Notify({
                                    Text = "[Bypass]: Please wait 2 seconds and don't move",
                                    Duration = 2,
                                    Type = "Warning"
                                })
                                task.wait(0.5)
                                Character:SetAttribute("Climbing", false)
                            end
                        end
                    end)
                end
            end)
        else
            if bypassLoop then
                task.cancel(bypassLoop)
                bypassLoop = nil
            end
            
            for _, highlight in pairs(ladderESP) do
                if highlight and highlight.Parent then
                    highlight:Destroy()
                end
            end
            ladderESP = {}
        end
    end, "Prevents ladder detection on Mines floor - highlights all ladders in blue")
    
    MinesTab:Label("âš ï¸ Speed is disabled on Mines floor for safety")
else
    MinesTab:Label("âš ï¸ Mines floor not detected")
end

-- ==================== VISUAL CATEGORY ====================
local VisualCategory = Window:CreateCategory("Visual", "ðŸ‘ï¸")

-- ESP Tab
local ESPTab = VisualCategory:CreateTab("ESP", "ðŸ“")

-- Display Tab
local DisplayTab = VisualCategory:CreateTab("Display", "ðŸŽ¨")

-- ESP Variables
local espEnabled = {
    Door = false,
    Objective = false,
    Entity = false
}
local espHighlights = {}
local espUpdateLoop

-- Function to clear ESP highlights
local function clearESP(espType)
    if espHighlights[espType] then
        for _, highlight in pairs(espHighlights[espType]) do
            if highlight and highlight.Parent then
                highlight:Destroy()
            end
        end
        espHighlights[espType] = {}
    end
end

-- Function to create ESP for doors
local function createDoorESP()
    if not espHighlights.Door then
        espHighlights.Door = {}
    end
    
    for _, room in pairs(workspace.CurrentRooms:GetChildren()) do
        pcall(function()
            local door = room:FindFirstChild("Door")
            if door and door:IsA("Model") then
                local hasESP = false
                for _, v in pairs(espHighlights.Door) do
                    if v and v.Parent == door then
                        hasESP = true
                        break
                    end
                end
                
                if not hasESP then
                    local highlight = Instance.new("Highlight")
                    highlight.FillColor = Color3.fromRGB(0, 255, 0)
                    highlight.OutlineColor = Color3.fromRGB(0, 200, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.Parent = door
                    table.insert(espHighlights.Door, highlight)
                end
            end
        end)
    end
end

-- Function to create ESP for objectives
local function createObjectiveESP()
    clearESP("Objective")
    espHighlights.Objective = {}
    
    for _, room in pairs(workspace.CurrentRooms:GetChildren()) do
        pcall(function()
            -- Check for KeyObtain
            local keyObtain = room:FindFirstChild("KeyObtain", true)
            if keyObtain then
                local highlight = Instance.new("Highlight")
                highlight.FillColor = Color3.fromRGB(255, 255, 0)
                highlight.OutlineColor = Color3.fromRGB(200, 200, 0)
                highlight.FillTransparency = 0.5
                highlight.OutlineTransparency = 0
                highlight.Parent = keyObtain
                table.insert(espHighlights.Objective, highlight)
                
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "ObjectiveESP"
                billboard.AlwaysOnTop = true
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 2, 0)
                billboard.Parent = keyObtain
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "Key"
                textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                textLabel.TextStrokeTransparency = 0
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboard
                
                table.insert(espHighlights.Objective, billboard)
            end
            
            -- Check for FuseHolder (Mines)
            local fuseHolder = room:FindFirstChild("FuseHolder", true)
            if fuseHolder then
                local highlight = Instance.new("Highlight")
                highlight.FillColor = Color3.fromRGB(255, 255, 0)
                highlight.OutlineColor = Color3.fromRGB(200, 200, 0)
                highlight.FillTransparency = 0.5
                highlight.OutlineTransparency = 0
                highlight.Parent = fuseHolder
                table.insert(espHighlights.Objective, highlight)
                
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "ObjectiveESP"
                billboard.AlwaysOnTop = true
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 2, 0)
                billboard.Parent = fuseHolder
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "Fuse"
                textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                textLabel.TextStrokeTransparency = 0
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboard
                
                table.insert(espHighlights.Objective, billboard)
            end
            
            -- Check for LiveHintBook in Bookshelves
            local assets = room:FindFirstChild("Assets")
            if assets then
                for _, bookshelf in pairs(assets:GetChildren()) do
                    if bookshelf.Name:match("Bookshelves") then
                        local liveHintBook = bookshelf:FindFirstChild("LiveHintBook", true)
                        if liveHintBook then
                            local highlight = Instance.new("Highlight")
                            highlight.FillColor = Color3.fromRGB(255, 255, 0)
                            highlight.OutlineColor = Color3.fromRGB(200, 200, 0)
                            highlight.FillTransparency = 0.5
                            highlight.OutlineTransparency = 0
                            highlight.Parent = liveHintBook
                            table.insert(espHighlights.Objective, highlight)
                            
                            local billboard = Instance.new("BillboardGui")
                            billboard.Name = "ObjectiveESP"
                            billboard.AlwaysOnTop = true
                            billboard.Size = UDim2.new(0, 100, 0, 50)
                            billboard.StudsOffset = Vector3.new(0, 2, 0)
                            billboard.Parent = liveHintBook
                            
                            local textLabel = Instance.new("TextLabel")
                            textLabel.Size = UDim2.new(1, 0, 1, 0)
                            textLabel.BackgroundTransparency = 1
                            textLabel.Text = "Book"
                            textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                            textLabel.TextStrokeTransparency = 0
                            textLabel.TextScaled = true
                            textLabel.Font = Enum.Font.GothamBold
                            textLabel.Parent = billboard
                            
                            table.insert(espHighlights.Objective, billboard)
                        end
                    end
                end
                
                -- Check for LeverForGate
                local lever = assets:FindFirstChild("LeverForGate")
                if lever then
                    local highlight = Instance.new("Highlight")
                    highlight.FillColor = Color3.fromRGB(255, 255, 0)
                    highlight.OutlineColor = Color3.fromRGB(200, 200, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.Parent = lever
                    table.insert(espHighlights.Objective, highlight)
                    
                    local billboard = Instance.new("BillboardGui")
                    billboard.Name = "ObjectiveESP"
                    billboard.AlwaysOnTop = true
                    billboard.Size = UDim2.new(0, 100, 0, 50)
                    billboard.StudsOffset = Vector3.new(0, 2, 0)
                    billboard.Parent = lever
                    
                    local textLabel = Instance.new("TextLabel")
                    textLabel.Size = UDim2.new(1, 0, 1, 0)
                    textLabel.BackgroundTransparency = 1
                    textLabel.Text = "Lever"
                    textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                    textLabel.TextStrokeTransparency = 0
                    textLabel.TextScaled = true
                    textLabel.Font = Enum.Font.GothamBold
                    textLabel.Parent = billboard
                    
                    table.insert(espHighlights.Objective, billboard)
                end
                
                -- Check for LiveBreakerPolePickup
                local breakerPole = assets:FindFirstChild("LiveBreakerPolePickup", true)
                if breakerPole then
                    local highlight = Instance.new("Highlight")
                    highlight.FillColor = Color3.fromRGB(255, 255, 0)
                    highlight.OutlineColor = Color3.fromRGB(200, 200, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.Parent = breakerPole
                    table.insert(espHighlights.Objective, highlight)
                    
                    local billboard = Instance.new("BillboardGui")
                    billboard.Name = "ObjectiveESP"
                    billboard.AlwaysOnTop = true
                    billboard.Size = UDim2.new(0, 100, 0, 50)
                    billboard.StudsOffset = Vector3.new(0, 2, 0)
                    billboard.Parent = breakerPole
                    
                    local textLabel = Instance.new("TextLabel")
                    textLabel.Size = UDim2.new(1, 0, 1, 0)
                    textLabel.BackgroundTransparency = 1
                    textLabel.Text = "Breaker"
                    textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                    textLabel.TextStrokeTransparency = 0
                    textLabel.TextScaled = true
                    textLabel.Font = Enum.Font.GothamBold
                    textLabel.Parent = billboard
                    
                    table.insert(espHighlights.Objective, billboard)
                end
            end
            
            -- Check for TimerLever
            local timerLever = room:FindFirstChild("TimerLever")
            if timerLever then
                local highlight = Instance.new("Highlight")
                highlight.FillColor = Color3.fromRGB(255, 255, 0)
                highlight.OutlineColor = Color3.fromRGB(200, 200, 0)
                highlight.FillTransparency = 0.5
                highlight.OutlineTransparency = 0
                highlight.Parent = timerLever
                table.insert(espHighlights.Objective, highlight)
                
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "ObjectiveESP"
                billboard.AlwaysOnTop = true
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 2, 0)
                billboard.Parent = timerLever
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "Timer Lever"
                textLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
                textLabel.TextStrokeTransparency = 0
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboard
                
                table.insert(espHighlights.Objective, billboard)
            end
        end)
    end
end
-- Function to create ESP for entities
local function createEntityESP()
    clearESP("Entity")
    espHighlights.Entity = {}
    
    -- ESP for Rush
    pcall(function()
        local rushMoving = workspace:FindFirstChild("RushMoving")
        if rushMoving and rushMoving:IsA("Model") then
            local hasESP = false
            for _, v in pairs(espHighlights.Entity) do
                if v.Parent == rushMoving then
                    hasESP = true
                    break
                end
            end
            
            if not hasESP then
                local highlight = Instance.new("Highlight")
                highlight.FillColor = Color3.fromRGB(255, 0, 0)
                highlight.OutlineColor = Color3.fromRGB(200, 0, 0)
                highlight.FillTransparency = 0.5
                highlight.OutlineTransparency = 0
                highlight.Parent = rushMoving
                table.insert(espHighlights.Entity, highlight)
                
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "EntityESP"
                billboard.AlwaysOnTop = true
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 3, 0)
                billboard.Parent = rushMoving
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "RUSH"
                textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                textLabel.TextStrokeTransparency = 0
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboard
                
                table.insert(espHighlights.Entity, billboard)
            end
        end
    end)
    
    -- ESP for Ambush
    pcall(function()
        local ambushMoving = workspace:FindFirstChild("AmbushMoving")
        if ambushMoving and ambushMoving:IsA("Model") then
            local hasESP = false
            for _, v in pairs(espHighlights.Entity) do
                if v.Parent == ambushMoving then
                    hasESP = true
                    break
                end
            end
            
            if not hasESP then
                local highlight = Instance.new("Highlight")
                highlight.FillColor = Color3.fromRGB(255, 100, 0)
                highlight.OutlineColor = Color3.fromRGB(200, 80, 0)
                highlight.FillTransparency = 0.5
                highlight.OutlineTransparency = 0
                highlight.Parent = ambushMoving
                table.insert(espHighlights.Entity, highlight)
                
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "EntityESP"
                billboard.AlwaysOnTop = true
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 3, 0)
                billboard.Parent = ambushMoving
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "AMBUSH"
                textLabel.TextColor3 = Color3.fromRGB(255, 100, 0)
                textLabel.TextStrokeTransparency = 0
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboard
                
                table.insert(espHighlights.Entity, billboard)
            end
        end
    end)
    
    -- ESP for Eyes
    pcall(function()
        local eyes = workspace:FindFirstChild("Eyes")
        if eyes and eyes:IsA("Model") then
            local hasESP = false
            for _, v in pairs(espHighlights.Entity) do
                if v.Parent == eyes then
                    hasESP = true
                    break
                end
            end
            
            if not hasESP then
                local highlight = Instance.new("Highlight")
                highlight.FillColor = Color3.fromRGB(150, 0, 255)
                highlight.OutlineColor = Color3.fromRGB(120, 0, 200)
                highlight.FillTransparency = 0.5
                highlight.OutlineTransparency = 0
                highlight.Parent = eyes
                table.insert(espHighlights.Entity, highlight)
                
                local billboard = Instance.new("BillboardGui")
                billboard.Name = "EntityESP"
                billboard.AlwaysOnTop = true
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 3, 0)
                billboard.Parent = eyes
                
                local textLabel = Instance.new("TextLabel")
                textLabel.Size = UDim2.new(1, 0, 1, 0)
                textLabel.BackgroundTransparency = 1
                textLabel.Text = "EYES"
                textLabel.TextColor3 = Color3.fromRGB(150, 0, 255)
                textLabel.TextStrokeTransparency = 0
                textLabel.TextScaled = true
                textLabel.Font = Enum.Font.GothamBold
                textLabel.Parent = billboard
                
                table.insert(espHighlights.Entity, billboard)
            end
        end
    end)
    
    -- ESP for Figure
    for _, room in pairs(workspace.CurrentRooms:GetChildren()) do
        pcall(function()
            local figureSetup = room:FindFirstChild("FigureSetup")
            if figureSetup then
                local figureRig = figureSetup:FindFirstChild("FigureRig")
                if figureRig then
                    local highlight = Instance.new("Highlight")
                    highlight.FillColor = Color3.fromRGB(255, 0, 0)
                    highlight.OutlineColor = Color3.fromRGB(200, 0, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.Parent = figureRig
                    table.insert(espHighlights.Entity, highlight)
                    
                    local billboard = Instance.new("BillboardGui")
                    billboard.Name = "EntityESP"
                    billboard.AlwaysOnTop = true
                    billboard.Size = UDim2.new(0, 100, 0, 50)
                    billboard.StudsOffset = Vector3.new(0, 3, 0)
                    billboard.Parent = figureRig
                    
                    local textLabel = Instance.new("TextLabel")
                    textLabel.Size = UDim2.new(1, 0, 1, 0)
                    textLabel.BackgroundTransparency = 1
                    textLabel.Text = "FIGURE"
                    textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
                    textLabel.TextStrokeTransparency = 0
                    textLabel.TextScaled = true
                    textLabel.Font = Enum.Font.GothamBold
                    textLabel.Parent = billboard
                    
                    table.insert(espHighlights.Entity, billboard)
                end
            end
        end)
    end
end

-- ESP Update Loop
local function startESPUpdateLoop()
    if espUpdateLoop then
        task.cancel(espUpdateLoop)
    end
    
    espUpdateLoop = task.spawn(function()
        while espEnabled.Door or espEnabled.Objective or espEnabled.Entity do
            task.wait(1)
            
            if espEnabled.Door then
                createDoorESP()
            end
            
            if espEnabled.Objective then
                createObjectiveESP()
            end
            
            if espEnabled.Entity then
                createEntityESP()
            end
        end
    end)
end

-- ESP Dropdown
ESPTab:Dropdown("ESP Types", {"Door", "Objective", "Entity"}, function(selected)
    if selected["Door"] and not espEnabled.Door then
        espEnabled.Door = true
        createDoorESP()
        startESPUpdateLoop()
    elseif not selected["Door"] and espEnabled.Door then
        espEnabled.Door = false
        clearESP("Door")
    end
    
    if selected["Objective"] and not espEnabled.Objective then
        espEnabled.Objective = true
        createObjectiveESP()
        startESPUpdateLoop()
    elseif not selected["Objective"] and espEnabled.Objective then
        espEnabled.Objective = false
        clearESP("Objective")
    end
    
    if selected["Entity"] and not espEnabled.Entity then
        espEnabled.Entity = true
        createEntityESP()
        startESPUpdateLoop()
    elseif not selected["Entity"] and espEnabled.Entity then
        espEnabled.Entity = false
        clearESP("Entity")
    end
    
    if not espEnabled.Door and not espEnabled.Objective and not espEnabled.Entity then
        if espUpdateLoop then
            task.cancel(espUpdateLoop)
            espUpdateLoop = nil
        end
    end
end, "Select which objects to highlight: Doors (green), Objectives (yellow), Entities (red)")

ESPTab:Label("ðŸŸ¢ Door ESP - Highlights all doors")
ESPTab:Label("ðŸŸ¡ Objective ESP - Keys, fuses, books, levers")
ESPTab:Label("ðŸ”´ Entity ESP - Rush, Ambush, Eyes, Figure")

-- Entity Notifier
local entityNotifierEnabled = false
local notifiedEntities = {}

ESPTab:Toggle("Entity Notifier", false, function(enabled)
    entityNotifierEnabled = enabled
    if not enabled then
        notifiedEntities = {}
    end
end, "Get notifications when entities spawn")

-- Entity Notifier Loop
task.spawn(function()
    while true do
        task.wait(0.5)
        if entityNotifierEnabled then
            pcall(function()
                local rushMoving = workspace:FindFirstChild("RushMoving")
                if rushMoving and not notifiedEntities["RushMoving"] then
                    notifiedEntities["RushMoving"] = true
                    Window:Notify({
                        Text = "Rush is coming!",
                        Duration = 5,
                        Type = "Error"
                    })
                elseif not rushMoving and notifiedEntities["RushMoving"] then
                    notifiedEntities["RushMoving"] = nil
                end
                
                local ambushMoving = workspace:FindFirstChild("AmbushMoving")
                if ambushMoving and not notifiedEntities["AmbushMoving"] then
                    notifiedEntities["AmbushMoving"] = true
                    Window:Notify({
                        Text = "Ambush is coming!",
                        Duration = 5,
                        Type = "Error"
                    })
                elseif not ambushMoving and notifiedEntities["AmbushMoving"] then
                    notifiedEntities["AmbushMoving"] = nil
                end
                
                local eyes = workspace:FindFirstChild("Eyes")
                if eyes and not notifiedEntities["Eyes"] then
                    notifiedEntities["Eyes"] = true
                    Window:Notify({
                        Text = "Eyes has appeared!",
                        Duration = 5,
                        Type = "Error"
                    })
                elseif not eyes and notifiedEntities["Eyes"] then
                    notifiedEntities["Eyes"] = nil
                end
            end)
        end
    end
end)

-- Display Tab - Fullbright
local fullbrightEnabled = false
local originalLighting = {}
local lightingConnection

DisplayTab:Toggle("Fullbright", false, function(enabled)
    fullbrightEnabled = enabled
    
    if enabled then
        local Lighting = game:GetService("Lighting")
        originalLighting = {
            Brightness = Lighting.Brightness,
            ClockTime = Lighting.ClockTime,
            FogEnd = Lighting.FogEnd,
            GlobalShadows = Lighting.GlobalShadows,
            Ambient = Lighting.Ambient
        }
        
        Lighting.Brightness = 2
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.Ambient = Color3.fromRGB(178, 178, 178)
        
        lightingConnection = Lighting.Changed:Connect(function(property)
            if fullbrightEnabled then
                if property == "Brightness" and Lighting.Brightness ~= 2 then
                    Lighting.Brightness = 2
                elseif property == "ClockTime" and Lighting.ClockTime ~= 14 then
                    Lighting.ClockTime = 14
                elseif property == "FogEnd" and Lighting.FogEnd ~= 100000 then
                    Lighting.FogEnd = 100000
                elseif property == "GlobalShadows" and Lighting.GlobalShadows ~= false then
                    Lighting.GlobalShadows = false
                elseif property == "Ambient" and Lighting.Ambient ~= Color3.fromRGB(178, 178, 178) then
                    Lighting.Ambient = Color3.fromRGB(178, 178, 178)
                end
            end
        end)
    else
        if lightingConnection then
            lightingConnection:Disconnect()
            lightingConnection = nil
        end
        
        local Lighting = game:GetService("Lighting")
        for property, value in pairs(originalLighting) do
            Lighting[property] = value
        end
    end
end, "See clearly in dark areas - removes fog and shadows")

-- FOV Slider
local RunService = game:GetService("RunService")
local desiredFOV = 70
local fovConnection

fovConnection = RunService.RenderStepped:Connect(function()
    pcall(function()
        local camera = workspace.CurrentCamera
        if camera and camera.FieldOfView ~= desiredFOV then
            camera.FieldOfView = desiredFOV
        end
    end)
end)

DisplayTab:Slider("FOV", 70, 120, 70, function(value)
    desiredFOV = value
end, "Adjust your field of view (default: 70)")

-- ==================== SETTINGS CATEGORY ====================
local SettingsCategory = Window:CreateCategory("Settings", "âš™ï¸")

-- Function to destroy the entire script
local function destroyScript()
    if lightingConnection then
        lightingConnection:Disconnect()
    end
    if fovConnection then
        fovConnection:Disconnect()
    end
    
    if spoofCrouchLoop then
        task.cancel(spoofCrouchLoop)
    end
    if antiSpeedLoop then
        task.cancel(antiSpeedLoop)
    end
    if bypassLoop then
        task.cancel(bypassLoop)
    end
    if speedLoop then
        task.cancel(speedLoop)
    end
    if noAccelLoop then
        task.cancel(noAccelLoop)
    end
    if autoProxiLoop then
        task.cancel(autoProxiLoop)
    end
    if flyLoop then
        task.cancel(flyLoop)
    end
    if espUpdateLoop then
        task.cancel(espUpdateLoop)
    end
    
    clearESP("Door")
    clearESP("Objective")
    clearESP("Entity")
    
    pcall(function()
        local Players = game:GetService("Players")
        local LocalPlayer = Players.LocalPlayer
        local Character = LocalPlayer and LocalPlayer.Character
        
        if Character then
            local Humanoid = Character:FindFirstChild("Humanoid")
            if Humanoid then
                Humanoid.WalkSpeed = originalWalkSpeed
            end
            
            local hrp = Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                hrp.CustomPhysicalProperties = originalHrpProps
            end
            
            if clonedCollision then
                clonedCollision:Destroy()
            end
            
            for _, part in pairs(Character:GetDescendants()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.CanCollide = true
                end
            end
        end
    end)
    
    if fullbrightEnabled then
        local Lighting = game:GetService("Lighting")
        for property, value in pairs(originalLighting) do
            Lighting[property] = value
        end
    end
    
    if screechDisabled and screechOriginalParent then
        pcall(function()
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local screech = ReplicatedStorage.Entities:FindFirstChild("Screech")
            if screech then
                screech.Parent = screechOriginalParent
            end
        end)
    end
    
    Window:Notify({
        Text = "Script destroyed! All features disabled.",
        Duration = 3,
        Type = "Warning"
    })
    
    task.wait(0.5)
    if Window.Destroy then
        Window:Destroy()
    end
end

SettingsCategory:Button("Destroy Script", function()
    destroyScript()
end, "âš ï¸ Completely removes the script and restores all game settings")

SettingsCategory:Button("Reset All Settings", function()
    spoofCrouchEnabled = false
    screechDisabled = false
    antiSpeedEnabled = false
    bypassEnabled = false
    speedEnabled = false
    noAccelEnabled = false
    autoProxiEnabled = false
    flyEnabled = false
    noclipEnabled = false
    fullbrightEnabled = false
    entityNotifierEnabled = false
    
    speedValue = 16
    proximityReach = 0
    desiredFOV = 70
    
    Window:Notify({
        Text = "All settings have been reset!",
        Duration = 2,
        Type = "Success"
    })
end, "Reset all toggles and values to default")

SettingsCategory:Button("Hide UI", function()
    Window:Hide()
end, "Hide the UI - press RightShift to show again")

SettingsCategory:Label("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
SettingsCategory:Label("ðŸŽ® ZeScript Doors v1.0")
SettingsCategory:Label("ðŸ“ Current Floor: " .. currentFloor)
SettingsCategory:Label("âŒ¨ï¸ Press RightShift to toggle UI")
SettingsCategory:Label("ðŸ” Use search box to find features")
SettingsCategory:Label("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

-- Show the window
wait(0.2)
Window:Show()

Window:Notify({
                Text = "if you enjoy the script please like it!",
                Duration = 25,
                Type = "Warning"
             }) 
